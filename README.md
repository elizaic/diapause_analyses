Git repository with Data and Code for "Adaptation at the edge: Patterns of local adaptation and genetic variation during a contemporary range expansion"
=======================================

This repository contains the data collected from diapause initiation studies,
a breeding study to determine heritability of diapause initiation, 
and the code used to analyze and visulaize the data.


## Data

The raw data from the two studies are in the `data` directory. 

* `diapause_local_adapt_data.csv` contains the raw data from the diapause local adaptation study.
  - `beetle_ID` is the unique identifier for each beetle.
  - `population` is the population the beetle was collected from.
  - `treatment` is the daylength treatment each beetle was assigned to. long = long treatment, short = short treatment.
  - `start_date` month/day/year the daylength treatment was started.
  - `end_date` month/day/year the daylength treatment was ended.
  - `diapause` 1 or 0 for if the beetle entered diapause or not.
  - `time_block` 1 or 2 indicates which block of the experiment the beetle was in.
  - `notes` any additional notes about the beetle.
* `weight_local_adapt_data.csv` contains the raw data of eclosion dates and beetle weights from the
local adaptation study. This dataset is joined to the `diapause_local_adapt_data.csv` dataset by `beetle_ID`, 
and not all beetles in this dataset were present in the diapause study.
  - `beetle_ID` is the unique identifier for each beetle.
  - `population` is the population the beetle was collected from.
  - `core_edge` is whether the beetle was from a core or edge population.
  - `weight` is the mass of the beetle in mg.
  - `weight_date` day/month that the weight measurement was taken. Year is 2018.
  - `sex` f for female and m for male beetles.
  - `eclosion` month/day/year the beetle eclosed.
* `diapause_herit_data.csv` contains the raw data from the breeding study to determine heritability of diapause initiation.
  - `beetle_ID` is the unique identifier for each beetle.
  - `sire` is the male parent of each beetle (numbers).
  - `dam` is the female parent of each beetle (letters).
  - `treatment` is the daylength treatment each beetle was assigned to. L = long treatment, S = short treatment.
  - `diapause` 1 or 0 for if the beetle entered diapause or not.
  - `time` number of days to enter diapause.
  - `dead` 1 if the beetle died before the end of the study.
  - `Day 1` - `Day 43` for each day of the study, 1 if the beetle layed at least 1 egg, 0 if no eggs.
  
  
## Code

The code used to analyze the data and create the figures is in the `scripts` directory.

- `diapause_analysis.R` contains the code used to analyze the diapause local adaptation data.
- `h2_analysis.R` contains the code used to analyze the breeding study and calculate heritability.

## Figures

The figures created from the data are in the `plots` directory.

All figures from the main text and supplementary materials are generated by the above code
and stored in this directory.


## To Run

To run the code, clone the repository and run the scripts in R. The code is written in R and the required packages
are noted at the top of each script.
